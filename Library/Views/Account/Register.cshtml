@model UserDTO
@{
    Layout = null;
    ViewBag.Title = "Login";
}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">

<style>
    * {
        font-family: Helvetica, Arial, sans-serif;
        font-size: 100%;
        line-height: 1.6em;
        margin: 0;
        padding: 0;
    }

    img {
        max-width: 600px;
    }

    body {
        -webkit-font-smoothing: antialiased;
        height: 100%;
        -webkit-text-size-adjust: none;
        width: 100% !important;
    }

    a {
        color: #348eda;
    }

    .btn-primary {
        Margin-bottom: 10px;
        width: auto !important;
    }

        .btn-primary td {
            background-color: #348eda;
            border-radius: 25px;
            font-family: Helvetica, Arial, "Lucida Grande", sans-serif;
            font-size: 14px;
            text-align: center;
            vertical-align: top;
        }

            .btn-primary td a {
                background-color: #348eda;
                border: solid 1px #348eda;
                border-radius: 25px;
                border-width: 10px 20px;
                display: inline-block;
                color: #ffffff;
                cursor: pointer;
                font-weight: bold;
                line-height: 2;
                text-decoration: none;
            }

    .last {
        margin-bottom: 0;
    }

    .first {
        margin-top: 0;
    }

    .padding {
        padding: 10px 0;
    }

    table.body-wrap {
        padding: 20px;
        width: 100%;
    }

        table.body-wrap .container {
            border: 1px solid #f0f0f0;
        }

    table.footer-wrap {
        clear: both !important;
        width: 100%;
    }

    .footer-wrap .container p {
        color: #666666;
        font-size: 12px;
    }

    table.footer-wrap a {
        color: #999999;
    }

    h1,
    h2,
    h3 {
        color: #111111;
        font-family: Helvetica, Arial, "Lucida Grande", sans-serif;
        font-weight: 200;
        line-height: 1.2em;
        margin: 40px 0 20px;
    }

    h1 {
        font-size: 24px;
    }

    h2 {
        font-size: 20px;
    }

    h3 {
        font-size: 18px;
    }

    p,
    ul,
    ol {
        font-size: 16px;
        font-weight: normal;
        margin-bottom: 10px;
    }

        ul li,
        ol li {
            margin-left: 5px;
            list-style-position: inside;
        }

    .container {
        clear: both !important;
        display: block !important;
        Margin: 0 auto !important;
        max-width: 600px !important;
    }

    .body-wrap .container {
        padding: 20px;
    }

    .content {
        display: block;
        margin: 0 auto;
        max-width: 600px;
    }

        .content table {
            width: 100%;
        }

    .verification-code {
        font-size: 32px;
        padding: 0px;
        margin: 0px;
        font-weight: bold;
        line-height: 36px;
    }

    .UserTextBox {
        width: 100%;
        padding: 12px 20px;
        margin: 8px 0;
        display: inline-block;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
    }

    .LoginSubmit {
        width: 50%;
        background-color: #EC4A43;
        color: white;
        padding: 14px 20px;
        margin: 8px 0;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }

        .LoginSubmit:hover {
            background-color: #c6120b;
        }

    .AreaContainer {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 25%;
    }

    td {
        margin-bottom: 15px;
    }
</style>
<div class="AreaContainer" id="app">

    <table class="body-wrap" bgcolor="#f6f6f6">
        <tr>
            <td></td>
            <td class="container" bgcolor="#FFFFFF">
                <div class="content">
                    <table>
                        <tr>
                            <td style="text-align:center">
                                <p>@ViewBag.Message</p>

                                <img src="~/Content/library-logo.png" width="70">
                                <p>&nbsp;</p>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input v-model="name" type="text" id="name" class="form-control form-control-lg mb-2" placeholder="Name" required />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input v-model="surname" type="text" id="surname" class="form-control form-control-lg mb-2" placeholder="Surname" required />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input v-model="email" type="email" id="email" class="form-control form-control-lg mb-2" placeholder="Email" required />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input v-model="tc" type="text" id="tc" class="form-control form-control-lg mb-2" placeholder="TC" required />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <input v-model="password" type="text" id="password" class="form-control form-control-lg mb-2" placeholder="password" required />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <select v-model="campusId" class="form-control form-control-lg mb-2" id="campus" aria-label="Default select example">
                                    <option value="0">Choose campus</option>
                                    <option value="1">Doğu Kampüsü</option>
                                    <option value="2">Batı Kampüsü</option>
                                    <option value="3">Küzey Kampüsü</option>
                                    <option value="4">Güney Kampüsü</option>

                                </select>
                            </td>
                        </tr>
                        <tr>
                            <td style="text-align:center">
                                <input v-on:click="register" type="button" class="LoginSubmit" value="Register">
                            </td>
                        </tr>

                    </table>
                </div>

            </td>
            <td></td>
        </tr>
    </table>
</div>
<div class="modal fade" id="MessageModal" @*tabindex="-1"*@ aria-labelledby="login" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content r-15">
            <div class="modal-body text-center p-30" id="MessageContent">

            </div>
        </div>
    </div>
</div>

<link href="~/Content/bootstrap.css" rel="stylesheet" />

<script src="~/Scripts/jquery-3.6.0.min.js"></script>
<script src="~/Scripts/bootstrap.js"></script>
<script src="~/Scripts/bootstrap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
<script>


    window.addEventListener('load', () => {
        new Vue({

            el: '#app',
            data: {
                name: '',
                surname: '',
                email: '',
                tc: '',
                campusId: 0,
                password: '',
            },

            mounted() {

            },
            watch: {

            },
            methods: {
                register() {
                    console.log("register");
                    if (this.name == '') {
                        $("#MessageModal #MessageContent").empty().append("Name field must be filled");
                        $('#MessageModal').modal('show');
                        return false;
                    }
                    if (this.surname == '') {
                        $("#MessageModal #MessageContent").empty().append("Surname field must be filled");
                        $('#MessageModal').modal('show');
                        return false;
                    }
                    if (this.tc == '') {
                        $("#MessageModal #MessageContent").empty().append("TC field must be filled");
                        $('#MessageModal').modal('show');
                        return false;
                    }
                    if (this.tc.length != 11) {
                        console.log(this.tc.length);
                        $("#MessageModal #MessageContent").empty().append("TC field must be 11 characters ");
                        $('#MessageModal').modal('show');
                        return false;
                    }
                    if (this.email == '') {
                        $("#MessageModal #MessageContent").empty().append("Email field must be filled");
                        $('#MessageModal').modal('show');
                        return false;
                    }
                    if (this.password == '') {
                        $("#MessageModal #MessageContent").empty().append("Password field must be filled");
                        $('#MessageModal').modal('show');
                        return false;
                    }
                    if (this.campusId == 0) {
                        $("#MessageModal #MessageContent").empty().append("Campus must be selected");
                        $('#MessageModal').modal('show');
                        return false;
                    }

                    var model = {
                        Name: this.name,
                        Surname: this.surname,
                        Email:this.email,
                        TC: this.tc,
                        PasswordHash: this.password,
                        CampusID: this.campusId,

                    };
                    $.ajax({
                        type: "POST",
                        url: "/Account/Register",
                        contentType: "application/json",
                        data: JSON.stringify(model),
                        success: function (data) {
                            if (data == 1) {
                                $("#MessageModal #MessageContent").empty().append("Registered Succesfully");
                                $('#MessageModal').modal('show');
                                setTimeout(function () {
                                    window.location.href = "/Home/Index";
                                }, 2000)

                            }
                            else {
                                $("#MessageModal #MessageContent").empty().append("error! try again");
                                $('#MessageModal').modal('show');
                            }

                        },
                        error: function (response) {
                            console.log("Hata");
                        }
                    });
                },
            }
        });
    });

</script>

